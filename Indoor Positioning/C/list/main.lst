C51 COMPILER V9.59.0.0   MAIN                                                              06/15/2020 00:04:59 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\list\main.obj
COMPILER INVOKED BY: D:\XX\MDK\C51\BIN\C51.EXE main.c COMPACT OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\list\m
                    -ain.lst) TABS(2) OBJECT(.\list\main.obj)

line level    source

   1          /******************************************************************************
   2            作者：神秘藏宝室
   3            店铺：ILoveMCU.taobao.com
   4            功能：
   5              LCD1602液晶显示
   6              若液晶看不清楚字，请旋转对比度调节的电位器到字清晰为止
   7          ******************************************************************************/
   8          #include "main.h"
   9          
  10          
  11          /*************  功能说明  **************
  12          
  13          本程序演示LED闪烁  
  14          
  15          
  16          ******************************************/
  17          
  18          /*************  本地常量声明  ******    1                 2             3           4               5           6               7             8             9     
             -        10            11            12          */
  19          u16 code fingerprint[10][12][3] =  {{{183,148,435},{207,186,435},{211,208,425},{220,234,406},{230,260,375}
             -,{235,281,353},{240,316,315},{230,347,275},{217,360,242},{199,375,210},{195,382,178},{189,377,172}},
  20                                              {{196,153,435},{210,173,434},{218,198,432},{235,225,410},{240,253,383},{252,280,350},{25
             -2,311,310},{244,343,273},{231,366,245},{216,387,212},{208,395,180},{200,385,175}},
  21                                              {{220,155,435},{234,174,434},{250,198,431},{264,224,412},{275,253,386},{280,276,351},{27
             -8,308,311},{268,338,273},{257,364,241},{252,380,215},{237,392,188},{219,381,172}},
  22                                              {{232,152,430},{258,173,428},{276,196,417},{290,222,399},{306,250,373},{313,272,336},{30
             -7,300,303},{292,328,268},{284,350,236},{277,370,217},{259,380,200},{255,368,183}},
  23                                              {{257,150,398},{278,168,403},{300,192,393},{322,213,380},{338,238,353},{343,262,320},{3
             -40,284,288},{323,308,258},{318,330,230},{304,347,206},{275,362,182},{256,355,168}},
  24                                              {{282,146,368},{309,162,379},{336,183,368},{350,199,350},{365,227,328},{373,248,300},{3
             -67,268,268},{357,289,246},{347,306,218},{332,320,204},{305,334,182},{277,324,165}},
  25                                              {{296,144,340},{325,158,345},{356,180,338},{374,193,325},{388,218,296},{395,236,277},{3
             -90,254,257},{382,269,238},{367,282,212},{352,292,198},{328,296,178},{302,288,163}},
  26                                              {{310,136,302},{336,144,305},{365,162,303},{389,179,293},{405,220,272},{415,214,254},{4
             -09,233,236},{400,249,218},{382,260,204},{363,265,189},{342,266,171},{313,261,154}},
  27                                              {{306,128,271},{336,138,276},{362,154,274},{383,164,268},{406,185,258},{410,198,242},{4
             -10,215,221},{402,227,203},{383,238,188},{364,247,170},{338,242,152},{304,237,140}},
  28                                              {{296,118,254},{323,124,255},{349,142,254},{369,152,245},{387,162,228},{397,175,210},{3
             -95,194,200},{383,203,188},{370,217,170},{350,222,155},{325,223,142},{298,221,140}}};
  29            
  30          
  31          
  32          
  33          /*************  本地变量声明  **************/
  34            u16 process_data[3];
  35            u8 coordinate[2];
  36            u16 RSS_data[3][10];
  37            u8 flag,m,n,x,y,z;
  38            u16 num,Difference,num1[3];
  39          
  40          
  41          /*************  本地函数声明  **************/
  42          void init()
  43          {
C51 COMPILER V9.59.0.0   MAIN                                                              06/15/2020 00:04:59 PAGE 2   

  44   1        AUXR = 0x00;
  45   1        TMOD = 0x01;
  46   1        TH0 = (65536 - 2400) / 256;
  47   1        TL0 = (65535 - 2400) % 256;
  48   1        EA = 1;
  49   1        ET0 = 1;
  50   1        TR0 = 1;
  51   1        temp = 0x01;
  52   1        m = 0;
  53   1        n = 0;
  54   1        flag = 0;
  55   1      }
  56          
  57          
  58          
  59          /*************  外部函数和变量声明 *****************/
  60          
  61          
  62          
  63          /******************** IO配置函数 **************************/
  64          void  GPIO_config(void)
  65          {
  66   1        P0M1 = 0; P0M0 = 0; //设置为准双向口
  67   1        P1M1 = 0; P1M0 = 0; //设置为准双向口
  68   1        P2M1 = 0; P2M0 = 0; //设置为准双向口
  69   1        P3M1 = 0; P3M0 = 0; //设置为准双向口
  70   1        P4M1 = 0; P4M0 = 0; //设置为准双向口
  71   1        P5M1 = 0; P5M0 = 0; //设置为准双向口
  72   1        P6M1 = 0; P6M0 = 0; //设置为准双向口
  73   1        P7M1 = 0; P7M0 = 0; //设置为准双向口
  74   1        P1M1 |= (1<<3);   // 把ADC口设置为高阻输入
  75   1        P1M0 &= ~(1<<3);
  76   1        P1ASF = (1<<3);   //P1.3做ADC
  77   1        ADC_CONTR = 0xE0; //90T, ADC power on
  78   1      }
  79          
  80          
  81          
  82          
  83          
  84          
  85          /******************** 主函数 **************************/
  86          void main(void)
  87          {
  88   1        init();
  89   1        GPIO_config();
  90   1        Init_LCD1602();
  91   1        
  92   1      
  93   1      
  94   1        while(1)
  95   1        {
  96   2          if(flag)
  97   2          {
  98   3            flag = 0;
  99   3            for(y = 0; y < 3; y++)
 100   3              {
 101   4                for(x = 0; x < 10; x++)
 102   4                {
 103   5                  process_data[y] += RSS_data[y][x];
 104   5                }
 105   4                process_data[y] /= 10;
C51 COMPILER V9.59.0.0   MAIN                                                              06/15/2020 00:04:59 PAGE 3   

 106   4              }
 107   3          }
 108   2      
 109   2          
 110   2          num = 25000;
 111   2          for(x = 0; x< 10; x++)
 112   2          {
 113   3            for(y = 0; y< 12; y++)
 114   3            {
 115   4              for(z = 0; z< 3; z++)
 116   4              {
 117   5                num1[z] = abs(fingerprint[x][y][z] - process_data[z]);
 118   5                Difference += num1[z];
 119   5              }
 120   4              if(num > Difference)
 121   4              {
 122   5                num = Difference;
 123   5                coordinate[0]=x+1;
 124   5                coordinate[1]=y+1;
 125   5              }
 126   4              Difference = 0;
 127   4            }
 128   3          }
 129   2          
 130   2          for(x = 0 ; x < 3 ; x++)
 131   2          {
 132   3            LCD1602_write_com(0x80+0x40+(5*x));  //指针指向第2行
 133   3            LCD1602_write_data((process_data[x])/100 + 0x30); //显示百位
 134   3            LCD1602_write_data((process_data[x])%100/10 + 0x30);//显示十位
 135   3            LCD1602_write_data((process_data[x])%10 + 0x30);  //显示个位
 136   3          }
 137   2          for(x = 0 ; x < 2 ; x++)
 138   2          {
 139   3            LCD1602_write_com(0x80+(5*x));  //指针指向第1行
 140   3            LCD1602_write_data((coordinate[x])/10 + 0x30);//显示十位
 141   3            LCD1602_write_data((coordinate[x])%10 + 0x30);  //显示个位
 142   3          }
 143   2          LCD1602_write_com(0x80+10);  //指针指向第1行
 144   2          LCD1602_write_data(num/100 + 0x30); //显示百位
 145   2          LCD1602_write_data(num%100/10 + 0x30);//显示十位
 146   2          LCD1602_write_data(num%10 + 0x30);  //显示个位
 147   2          delay_ms(1000);
 148   2        }
 149   1      }
 150          
 151          void Led_flash() interrupt 1
 152          {
 153   1        TH0 = (65536 - 2400) / 256;   //128Hz
 154   1        TL0 = (65535 - 2400) % 256;
 155   1        temp = _crol_(temp,1);
 156   1        if(temp == 0x08)
 157   1          temp = 0x01;
 158   1        P0 = temp;
 159   1        
 160   1        Delay1ms();
 161   1      
 162   1        RSS_data[m][n] = coll_data_1();
 163   1        m++;
 164   1        if(m >= 3)
 165   1        {
 166   2          n++;
 167   2          m = 0;
C51 COMPILER V9.59.0.0   MAIN                                                              06/15/2020 00:04:59 PAGE 4   

 168   2        }
 169   1        if(n >= 10)
 170   1        {
 171   2          flag = 1;
 172   2          n = 0;
 173   2        }
 174   1      }
 175          
 176          
 177          
 178          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    871    ----
   CONSTANT SIZE    =    720    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =     85    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
